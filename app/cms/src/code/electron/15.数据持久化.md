# æ•°æ®æŒä¹…åŒ–

ç”±äº Electron æœ¬èº«ä½“è´¨ç‰¹æ®Šï¼Œæ˜¯ Chromium å’Œ Node.js çš„ç»“åˆä½“ï¼Œå› æ­¤åœ¨å®ç°æ•°æ®æŒä¹…åŒ–çš„æ—¶å€™ï¼Œå¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹ï¼š

- åŸºäº Node.js çš„æœ¬åœ°æ–‡ä»¶æŒä¹…åŒ–
- åŸºäºæµè§ˆå™¨æŠ€æœ¯çš„æŒä¹…åŒ–

## è®¾ç½®å­˜å‚¨ç›®å½•

é¦–å…ˆç¬¬ä¸€æ­¥æˆ‘ä»¬éœ€è¦è®¾ç½®ç”¨æˆ·æ•°æ®å­˜å‚¨ç›®å½•ã€‚æ³¨æ„ï¼Œè¿™ä¸ªç›®å½•ä¸€èˆ¬ä¸ä¼šè®¾ç½®åœ¨å®‰è£…ç›®å½•ä¸‹é¢ï¼Œå› ä¸ºå®‰è£…ç›®å½•ä¸å¯é ï¼Œéšæ—¶é¢ä¸´è¢«æ¸…ç©ºé‡ç½®çš„å¯èƒ½ã€‚

ä¸€èˆ¬æ¥è®²ï¼Œæ“ä½œç³»ç»Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„ç›®å½•ï¼Œæ¥ä¸ºåº”ç”¨ç¨‹åºå­˜å‚¨å¯¹åº”çš„ç”¨æˆ·ä¸ªæ€§åŒ–æ•°æ®ã€‚

ä¸åŒçš„æ“ä½œç³»ç»Ÿé‡Œé¢ï¼Œå¯¹åº”çš„è¿™ä¸ªé»˜è®¤ç›®å½•åœ°å€æ˜¯ä¸ä¸€æ ·çš„ã€‚

**Windows**

- ç”¨æˆ·æ•°æ®ç›®å½•ï¼šåœ¨ Windows æ“ä½œç³»ç»Ÿä¸­ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸åœ¨ä»¥ä¸‹è·¯å¾„ä¹‹ä¸€å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼š
  - `C:\Users\[ç”¨æˆ·å]\AppData\Roaming\`ï¼šç”¨äºå­˜å‚¨æ¼«æ¸¸æ•°æ®ï¼Œå³ç”¨æˆ·åœ¨ä¸åŒè®¡ç®—æœºä¸Šä½¿ç”¨ç›¸åŒç”¨æˆ·è´¦æˆ·æ—¶å¯ä»¥è®¿é—®çš„æ•°æ®ã€‚
  - `C:\Users\[ç”¨æˆ·å]\AppData\Local\`ï¼šç”¨äºå­˜å‚¨ç‰¹å®šäºå•ä¸ªè®¡ç®—æœºçš„æ•°æ®ã€‚
- ç¨‹åºæ•°æ®ç›®å½•ï¼šå¯¹äºæ‰€æœ‰ç”¨æˆ·å…±äº«çš„åº”ç”¨æ•°æ®ï¼Œé€šå¸¸å­˜å‚¨åœ¨ `C:\ProgramData\` ç›®å½•ã€‚

**macOS**

- ç”¨æˆ·æ•°æ®ç›®å½•: åœ¨macOSä¸­ï¼Œåº”ç”¨ç¨‹åºçš„ç”¨æˆ·æ•°æ®é€šå¸¸å­˜å‚¨åœ¨ç”¨æˆ·çš„åº“ç›®å½•ï¼ˆLibraryï¼‰ä¸­ï¼Œè·¯å¾„ä¸ºï¼š
  - `/Users/[ç”¨æˆ·å]/Library/`ï¼šè¿™ä¸ªç›®å½•ç”¨äºå­˜å‚¨åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶ã€ç¼“å­˜å’Œå…¶ä»–ç”¨æˆ·ç‰¹å®šçš„æ•°æ®ã€‚
- åº”ç”¨æ”¯æŒç›®å½•ï¼šç‰¹åˆ«æ˜¯ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºå°†æ•°æ®å­˜å‚¨åœ¨ `/Users/[ç”¨æˆ·å]/Library/Application Support/` ç›®å½•ã€‚

**Linux**

- ç”¨æˆ·æ•°æ®ç›®å½•ï¼šåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¸ªæ€§åŒ–æ•°æ®é€šå¸¸å­˜å‚¨åœ¨ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹çš„éšè—æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›ç›®å½•çš„åç§°é€šå¸¸ä»¥ç‚¹ï¼ˆ . ï¼‰å¼€å§‹ï¼Œä¾‹å¦‚ï¼š`/home/[ç”¨æˆ·å]/.[åº”ç”¨ç¨‹åºåç§°]/`ï¼šç”¨äºå­˜å‚¨è¯¥åº”ç”¨ç¨‹åºçš„ä¸ªæ€§åŒ–è®¾ç½®å’Œæ•°æ®ã€‚
- é…ç½®æ–‡ä»¶ï¼šä¸€äº›é€šç”¨çš„é…ç½®æ–‡ä»¶å¯èƒ½å­˜å‚¨åœ¨ `/home/[ç”¨æˆ·å]/.config/` ç›®å½•ä¸­ã€‚

åœ¨ Electron ä¸­å¯ä»¥é€šè¿‡ app.getPath("userData") æ¥è·å–åˆ°é»˜è®¤çš„ç”¨æˆ·æ•°æ®ç›®å½•ã€‚

å¦å¤–ï¼Œåœ¨ app.getPath æ–¹æ³•ä¸­ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼Œèƒ½å¤Ÿè·å–åˆ°ä¸åŒç”¨é€”çš„è·¯å¾„ï¼š

- `"home"`: ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚
- `"appData"`: å½“å‰ç”¨æˆ·çš„åº”ç”¨ç¨‹åºç›®å½•ã€‚
- `"userData"`: å¯¹åº”ç”¨æˆ·ä¸ªæ€§åŒ–æ•°æ®çš„ç›®å½•ã€‚
- `"temp"`: ä¸´æ—¶æ–‡ä»¶ç›®å½•ã€‚
- `"exe"`: å½“å‰çš„å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•ã€‚
- `"desktop"`: ç”¨æˆ·çš„æ¡Œé¢ç›®å½•ã€‚
- `"documents"`: ç”¨æˆ·çš„æ–‡æ¡£ç›®å½•ã€‚
- `"downloads"`: ç”¨æˆ·çš„ä¸‹è½½ç›®å½•ã€‚
- `"music"`: ç”¨æˆ·çš„éŸ³ä¹ç›®å½•ã€‚
- `"pictures"`: ç”¨æˆ·çš„å›¾ç‰‡ç›®å½•ã€‚
- `"videos"`: ç”¨æˆ·çš„è§†é¢‘ç›®å½•ã€‚

ä¾‹å¦‚ï¼š

```js
console.log(app.getPath("userData")); // /Users/jie/Library/Application Support/demo
console.log(app.getPath("home")); // /Users/jie
console.log(app.getPath("desktop")); // /Users/jie/Desktop
console.log(app.getPath("documents")); // /Users/jie/Documents
console.log(app.getPath("downloads")); // /Users/jie/Downloads
console.log(app.getPath("music")); // /Users/jie/Music
```

æœ‰äº›æ—¶å€™ï¼Œä¸ºäº†æå‡ç”¨æˆ·çš„ä½“éªŒï¼Œå…è®¸ç”¨æˆ·è‡ªå·±æ¥é€‰æ‹©å°†åº”ç”¨çš„ç”¨æˆ·æ•°æ®å­˜å‚¨åˆ°å“ªä¸ªä½ç½®ï¼Œé€šè¿‡ï¼š

```js
app.setPath("appData", "path");
```

- appDataï¼š è¦é‡ç½®çš„è·¯å¾„çš„åç§°
- pathï¼šå…·ä½“çš„è·¯å¾„

## è¯»å†™æœ¬åœ°æ–‡ä»¶

å…³äºè¯»å†™æœ¬åœ°æ–‡ä»¶è¿™ä¸€å—å„¿ï¼Œå°±æ˜¯åˆ©ç”¨ Node.js é‡Œé¢å’Œæ–‡ä»¶å¤„ç†ç›¸å…³çš„ fs æ¨¡å—çš„ APIã€‚

è¿™é‡Œå†æ¨èä¸€ä¸ªç¬¬ä¸‰æ–¹çš„åº“ï¼šfs-extraï¼Œè¿™ä¸ªåº“åœ¨åŸæœ¬çš„ fs æ¨¡å—çš„åŸºç¡€ä¸Šåˆåšäº†ä¸€å±‚å°è£…ï¼Œæ·»åŠ äº†å¾ˆå¤šæ›´å¥½ç”¨çš„ APIã€‚

åŸç”Ÿ fs æ¨¡å—ï¼Œåœ¨åˆ é™¤ä¸€ä¸ªç›®å½•çš„æ—¶å€™ï¼Œå¦‚æœè¯¥ç›®å½•ä¸‹é¢æœ‰å­ç›®å½•ï¼Œå­ç›®å½•ä¸‹é¢åˆæœ‰å­ç›®å½•ï¼Œé‚£ä¹ˆè¯¥ç›®å½•æ˜¯æ— æ³•åˆ é™¤ï¼Œè¦åˆ é™¤ä¸€ä¸ªç›®å½•çš„å‰æå°±æ˜¯è¯¥ç›®å½•å¿…é¡»æ˜¯ç©ºçš„ï¼Œå› æ­¤åœ¨åŸç”Ÿ fs æ¨¡å—é‡Œé¢ï¼Œå°±ä¼šæ¶‰åŠåˆ°é€’å½’æ“ä½œ

```js
const fs = require("fs");
const path = require("path");

function deleteDirectory(directoryPath) {
  if (fs.existsSync(directoryPath)) {
    fs.readdirSync(directoryPath).forEach((file) => {
      const currentPath = path.join(directoryPath, file);
      if (fs.lstatSync(currentPath).isDirectory()) {
        // é€’å½’åˆ é™¤å­ç›®å½•
        deleteDirectory(currentPath);
      } else {
        // åˆ é™¤æ–‡ä»¶
        fs.unlinkSync(currentPath);
      }
    });
    // åˆ é™¤ç›®å½•
    fs.rmdirSync(directoryPath);
    console.log(`Directory ${directoryPath} has been removed successfully.`);
  } else {
    console.log("Directory not found.");
  }
}

// å®šä¹‰è¦åˆ é™¤çš„ç›®å½•è·¯å¾„
const dirPath = "./path/to/your/directory";

try {
  deleteDirectory(dirPath);
} catch (err) {
  console.error(`Error occurred while removing directory: ${err.message}`);
}
```

fs-extra

```js
const fs = require("fs-extra");

// å®šä¹‰è¦åˆ é™¤çš„ç›®å½•è·¯å¾„
const directoryPath = "./path/to/your/directory";

try {
  // åˆ é™¤ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹
  fs.removeSync(directoryPath);
  console.log(`Directory ${directoryPath} has been removed successfully.`);
} catch (err) {
  console.error(`Error occurred while removing directory: ${err.message}`);
}
```

ç¤ºä¾‹äºŒ

åŸç”Ÿ fs æ¨¡å—åœ¨åˆ›å»ºç›®å½•ä¹‹å‰éœ€è¦å…ˆåˆ¤æ–­è¯¥ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œåªæœ‰åœ¨ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤Ÿåˆ›å»º

åŸç”Ÿ fs æ¨¡å—ç›¸å…³ä»£ç ï¼š

```js
const fs = require("fs");
const path = require("path");

const dirPath = path.join(__dirname, "exampleDir");

// æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨
if (!fs.existsSync(dirPath)) {
  // å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒ
  fs.mkdirSync(dirPath, { recursive: true });
  console.log("Directory created successfully!");
} else {
  console.log("Directory already exists.");
}
```

fs-extra æ¨¡å—æä¾›äº† ensureDir æ–¹æ³•ï¼š

```js
const fs = require("fs-extra");
const path = require("path");

const dirPath = path.join(__dirname, "exampleDir");

// å¦‚æœå·²ç»å­˜åœ¨ï¼Œä»£ç å°†ç»§ç»­æ‰§è¡Œè€Œä¸ä¼šå‘ç”Ÿé”™è¯¯ã€‚
// å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒ
fs.ensureDir(dirPath)
  .then(() => console.log("Directory ensured successfully!"))
  .catch((err) => console.error(err));
```

å…³äº fs-extra æ›´å¤šå†…å®¹å¯ä»¥å‚é˜…ï¼šhttps://github.com/jprichardson/node-fs-extra

## ç¬¬ä¸‰æ–¹åº“

æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬è¦å­˜å‚¨çš„æ•°æ®å°±æ˜¯ä¸€ä¸ªç®€å• JSON æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€‰æ‹© electron-store æ¥è¿›è¡Œå­˜å‚¨ã€‚

electron-store æ˜¯ä¸“ä¸º Electron è®¾è®¡ï¼Œå¹¶ä¸”ä¸“é—¨ç”¨äºå­˜å‚¨ JSON è¿™ç§è½»é‡çº§æ•°æ®ã€‚

æˆ‘ä»¬åœ¨ä½¿ç”¨è¿™ä¸ªç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œå¼•å…¥å³ç”¨ï¼Œéƒ½ä¸éœ€è¦æŒ‡å®šæ–‡ä»¶çš„è·¯å¾„å’Œæ–‡ä»¶åã€‚

å¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š

**å¼•å…¥å’Œå®ä¾‹åŒ–**

åœ¨ Electron çš„ä¸»è¿›ç¨‹æˆ–æ¸²æŸ“è¿›ç¨‹ä¸­ï¼Œå¼•å…¥å¹¶å®ä¾‹åŒ– `electron-store`ï¼š

```js
const Store = require("electron-store");
const store = new Store();
```

**å­˜å‚¨æ•°æ®**

ä½¿ç”¨ `set` æ–¹æ³•å­˜å‚¨æ•°æ®ã€‚æ‚¨å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ç­‰ç±»å‹çš„æ•°æ®ï¼š

```js
// å­˜å‚¨ä¸€ä¸ªç®€å•çš„å€¼
store.set("unicorn", "ğŸ¦„");

// å­˜å‚¨ä¸€ä¸ªå¯¹è±¡
store.set("user", {
  name: "Alice",
  age: 25,
});
```

**è¯»å–æ•°æ®**

ä½¿ç”¨ `get` æ–¹æ³•è¯»å–æ•°æ®ï¼Œå¦‚æœæŒ‡å®šçš„é”®ä¸å­˜åœ¨ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ï¼š

```js
// è¯»å–æ•°æ®
console.log(store.get("unicorn")); // è¾“å‡ºï¼šğŸ¦„

// è¯»å–å¯¹è±¡çš„å±æ€§
console.log(store.get("user.name")); // è¾“å‡ºï¼šAlice

// è¯»å–ä¸å­˜åœ¨çš„é”®ï¼Œè¿”å›é»˜è®¤å€¼
console.log(store.get("foo", "é»˜è®¤å€¼")); // è¾“å‡ºï¼šé»˜è®¤å€¼
```

**æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨**

ä½¿ç”¨ `has` æ–¹æ³•æ£€æŸ¥å­˜å‚¨ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé”®ï¼š

```js
if (store.has("unicorn")) {
  console.log("Unicorn exists");
}
```

**åˆ é™¤æ•°æ®**

ä½¿ç”¨ `delete` æ–¹æ³•åˆ é™¤å­˜å‚¨ä¸­çš„æ•°æ®ï¼š

```js
// åˆ é™¤ä¸€ä¸ªé”®
store.delete("unicorn");
```

**é…ç½®å’Œé€‰é¡¹**

åœ¨å®ä¾‹åŒ– `electron-store` æ—¶ï¼Œæ‚¨å¯ä»¥ä¼ é€’ä¸€äº›é€‰é¡¹æ¥è‡ªå®šä¹‰å…¶è¡Œä¸ºï¼š

```js
const store = new Store({
  name: "my-data", // è‡ªå®šä¹‰å­˜å‚¨æ–‡ä»¶çš„åç§°ï¼Œé»˜è®¤æ˜¯ 'config'
  encryptionKey: "aes-256-cbc", // åŠ å¯†å­˜å‚¨çš„æ•°æ®
  cwd: "some/path", // è‡ªå®šä¹‰å­˜å‚¨æ–‡ä»¶çš„è·¯å¾„
  fileExtension: "json", // æ–‡ä»¶æ‰©å±•åï¼Œé»˜è®¤æ˜¯ 'json'
});
```

å¦å¤–ï¼Œelectron-store é»˜è®¤æ˜¯å°†æ•°æ®å­˜å‚¨åˆ°å¯¹åº”æ“ä½œç³»ç»Ÿçš„ userData ç›®å½•ä¸‹é¢ã€‚

- macOSï¼š`~/Library/Application Support/YourApp`
- Windowsï¼š`C:\Users\YourName\AppData\Local\YourApp`

æ›´å¤šå…³äº electron-store çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚é˜…ï¼šhttps://github.com/sindresorhus/electron-store

# æµè§ˆå™¨æŠ€æœ¯æŒä¹…åŒ–

- localStorage
- IndexedDB

## localStorage

åœ¨ Electron ä¸­ï¼Œå¦‚æœä½ æ‰“å¼€äº†å¤šä¸ª BrowserWindow çš„å®ä¾‹ï¼Œé‚£ä¹ˆå®ƒä»¬é»˜è®¤æƒ…å†µä¸‹ä¼šå…±äº«åŒä¸€ä¸ª localStorage ç©ºé—´ã€‚

å¦å¤–ï¼Œå…³äºå¤šä¸ªçª—å£æ˜¯å¦å…±äº« localStorage è¿™ä¸€ç‚¹ï¼Œè™½ç„¶é»˜è®¤æ˜¯å¤šçª—å£å…±äº«ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è¿›è¡Œé…ç½®çš„ã€‚

ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºçª—å£äºŒçš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š

```js
const secondWin = new BrowserWindow({
  width: 800,
  height: 600,
  webPreferences: {
    nodeIntegration: true,
    contextIsolation: false,
    partition: "persist:myCustomPartition",
  },
});
```

- partitionï¼šç”¨äºå®šä¹‰è¯¥çª—å£æ•°æ®å­˜å‚¨çš„ç‹¬ç«‹æ€§å’ŒæŒä¹…æ€§
  - persistï¼šè¿™æ˜¯ä¸€ä¸ªå‰ç¼€ï¼Œè¯¥å‰ç¼€è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæŒä¹…æ€§çš„ä¼šè¯
  - myCustomPartitionï¼šè¿™ä¸ªæ ‡è¯†ç¬¦ä»£è¡¨è¯¥ä¼šè¯çš„å”¯ä¸€åç§°ã€‚è¿™é‡Œå°±æ˜¯é€šè¿‡ä¸åŒçš„ partition åç§°ï¼Œç»™åº”ç”¨ä¸­çš„ä¸åŒçª—å£åˆ›å»ºäº†éš”ç¦»çš„å­˜å‚¨ç©ºé—´ã€‚

# æµè§ˆå™¨æŠ€æœ¯æŒä¹…åŒ–

- localStorage
- IndexedDB

## localStorage

åœ¨ Electron ä¸­ï¼Œå¦‚æœä½ æ‰“å¼€äº†å¤šä¸ª BrowserWindow çš„å®ä¾‹ï¼Œé‚£ä¹ˆå®ƒä»¬é»˜è®¤æƒ…å†µä¸‹ä¼šå…±äº«åŒä¸€ä¸ª localStorage ç©ºé—´ã€‚

å¦å¤–ï¼Œå…³äºå¤šä¸ªçª—å£æ˜¯å¦å…±äº« localStorage è¿™ä¸€ç‚¹ï¼Œè™½ç„¶é»˜è®¤æ˜¯å¤šçª—å£å…±äº«ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è¿›è¡Œé…ç½®çš„ã€‚

ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºçª—å£äºŒçš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š

```js
const secondWin = new BrowserWindow({
  width: 800,
  height: 600,
  webPreferences: {
    nodeIntegration: true,
    contextIsolation: false,
    partition: "persist:myCustomPartition",
  },
});
```

- partitionï¼šç”¨äºå®šä¹‰è¯¥çª—å£æ•°æ®å­˜å‚¨çš„ç‹¬ç«‹æ€§å’ŒæŒä¹…æ€§
  - persistï¼šè¿™æ˜¯ä¸€ä¸ªå‰ç¼€ï¼Œè¯¥å‰ç¼€è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæŒä¹…æ€§çš„ä¼šè¯
  - myCustomPartitionï¼šè¿™ä¸ªæ ‡è¯†ç¬¦ä»£è¡¨è¯¥ä¼šè¯çš„å”¯ä¸€åç§°ã€‚è¿™é‡Œå°±æ˜¯é€šè¿‡ä¸åŒçš„ partition åç§°ï¼Œç»™åº”ç”¨ä¸­çš„ä¸åŒçª—å£åˆ›å»ºäº†éš”ç¦»çš„å­˜å‚¨ç©ºé—´ã€‚

## IndexedDB

IndexedDB æ˜¯ä¸€ç§ä½çº§çš„ APIï¼Œç”¨äºåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­å­˜å‚¨å¤§é‡çš„ç»“æ„åŒ–æ•°æ®ã€‚è¿™ä¸ª API ä½¿ç”¨ç´¢å¼•æ¥å®ç°å¯¹æ•°æ®çš„é«˜æ€§èƒ½æœç´¢ã€‚å®ƒå…è®¸ä½ åˆ›å»ºã€è¯»å–ã€å¯¼èˆªå’Œå†™å…¥å®¢æˆ·ç«¯æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚IndexedDB å¯¹äºéœ€è¦åœ¨å®¢æˆ·ç«¯å­˜å‚¨å¤§é‡æ•°æ®æˆ–æ— éœ€æŒç»­è”ç½‘çš„åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ã€‚

### åŸºç¡€ä»‹ç»

- **æ•°æ®åº“**ï¼šIndexedDB åˆ›å»ºçš„æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­å­˜å‚¨é”®å€¼å¯¹ã€‚
- **å¯¹è±¡ä»“åº“**ï¼šè¿™æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªâ€œè¡¨â€ï¼Œç”¨äºå­˜å‚¨æ•°æ®å¯¹è±¡ã€‚
- **äº‹åŠ¡**ï¼šæ•°æ®çš„è¯»å†™æ“ä½œæ˜¯é€šè¿‡äº‹åŠ¡è¿›è¡Œçš„ã€‚
- **é”®**ï¼šæ•°æ®å­˜å‚¨çš„æ ‡è¯†ã€‚
- **ç´¢å¼•**ï¼šç”¨äºé«˜æ•ˆæœç´¢æ•°æ®ã€‚

### æ‰“å¼€æ•°æ®åº“

åœ¨ä½¿ç”¨ IndexedDB ä¹‹å‰ï¼Œéœ€è¦æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºå®ƒã€‚

```javascript
let db;
const request = indexedDB.open("MyTestDatabase", 1);

request.onerror = function (event) {
  // é”™è¯¯å¤„ç†
  console.log("Database error: " + event.target.errorCode);
};

request.onsuccess = function (event) {
  db = event.target.result;
};
```

### åˆ›å»ºå¯¹è±¡ä»“åº“

å¯¹è±¡ä»“åº“ç±»ä¼¼äº SQL æ•°æ®åº“ä¸­çš„è¡¨ã€‚ä»¥ä¸‹æ˜¯åœ¨æ•°æ®åº“çš„å‡çº§è¿‡ç¨‹ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“çš„ç¤ºä¾‹ï¼š

```javascript
request.onupgradeneeded = function (event) {
  const db = event.target.result;

  // åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“æ¥å­˜å‚¨æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ "id" ä½œä¸ºé”®è·¯å¾„ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾å®ƒæ˜¯å”¯ä¸€çš„ã€‚
  const objectStore = db.createObjectStore("name", { keyPath: "id" });

  // åˆ›å»ºä¸€ä¸ªç´¢å¼•æ¥é€šè¿‡ name è¿›è¡Œæœç´¢ã€‚
  objectStore.createIndex("name", "name", { unique: false });
};
```

### æ·»åŠ æ•°æ®

ä¸€æ—¦æœ‰äº†å¯¹è±¡ä»“åº“ï¼Œå°±å¯ä»¥å¾€é‡Œé¢æ·»åŠ æ•°æ®äº†ã€‚è¿™éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆã€‚

```javascript
function addData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");

  const data = { id: "1", name: "Zhang San" };
  const request = objectStore.add(data);

  request.onsuccess = function (event) {
    console.log("æ•°æ®æ·»åŠ æˆåŠŸ");
  };

  request.onerror = function (event) {
    console.log("æ•°æ®æ·»åŠ å¤±è´¥");
  };
}
```

### è¯»å–æ•°æ®

ä»å¯¹è±¡ä»“åº“ä¸­è¯»å–æ•°æ®ä¹Ÿå¾ˆç®€å•ï¼š

```javascript
function readData() {
  const transaction = db.transaction(["name"]);
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1"); // ä½¿ç”¨ id è¯»å–æ•°æ®

  request.onerror = function (event) {
    console.log("äº‹åŠ¡å¤±è´¥");
  };

  request.onsuccess = function (event) {
    if (request.result) {
      console.log("Name: " + request.result.name);
    } else {
      console.log("æœªæ‰¾åˆ°æ•°æ®");
    }
  };
}
```

### æ›´æ–°æ•°æ®

æ›´æ–°æ•°æ®ä¸æ·»åŠ æ•°æ®ç±»ä¼¼ï¼Œä½†é€šå¸¸ä¼šå…ˆè¯»å–ç°æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ã€‚

```javascript
function updateData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1");

  request.onsuccess = function (event) {
    const data = event.target.result;
    data.name = "Li Si"; // ä¿®æ”¹åç§°

    const requestUpdate = objectStore.put(data);
    requestUpdate.onerror = function (event) {
      console.log("æ›´æ–°å¤±è´¥");
    };
    requestUpdate.onsuccess = function (event) {
      console.log("æ›´æ–°æˆåŠŸ");
    };
  };
}
```

### åˆ é™¤æ•°æ®

åˆ é™¤æ•°æ®ä¹Ÿå¾ˆç›´æ¥ï¼š

```javascript
function deleteData() {
  const request = db
    .transaction(["name"], "readwrite")
    .objectStore("name")
    .delete("1");

  request.onsuccess = function (event) {
    console.log("æ•°æ®åˆ é™¤æˆåŠŸ");
  };
}
```

ä»¥ä¸Šå°±æ˜¯ IndexedDB çš„åŸºæœ¬ç”¨æ³•ã€‚é€šè¿‡è¿™äº›åŸºæœ¬æ“ä½œï¼Œå¯ä»¥åœ¨å‰ç«¯åº”ç”¨ä¸­å®ç°å¤æ‚çš„æ•°æ®å­˜å‚¨éœ€æ±‚ã€‚ä¸è¿‡ï¼Œè®°å¾— IndexedDB çš„æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦ç®¡ç†å¥½å›è°ƒæˆ–è€…ä½¿ç”¨`async/await`æ¥å¤„ç†è¿™äº›å¼‚æ­¥æ“ä½œã€‚

## æµè§ˆå™¨æŠ€æœ¯æŒä¹…åŒ–

- localStorage
- IndexedDB
- Dexie.js

## localStorage

åœ¨ Electron ä¸­ï¼Œå¦‚æœä½ æ‰“å¼€äº†å¤šä¸ª BrowserWindow çš„å®ä¾‹ï¼Œé‚£ä¹ˆå®ƒä»¬é»˜è®¤æƒ…å†µä¸‹ä¼šå…±äº«åŒä¸€ä¸ª localStorage ç©ºé—´ã€‚

å¦å¤–ï¼Œå…³äºå¤šä¸ªçª—å£æ˜¯å¦å…±äº« localStorage è¿™ä¸€ç‚¹ï¼Œè™½ç„¶é»˜è®¤æ˜¯å¤šçª—å£å…±äº«ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è¿›è¡Œé…ç½®çš„ã€‚

ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºçª—å£äºŒçš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š

```js
const secondWin = new BrowserWindow({
  width: 800,
  height: 600,
  webPreferences: {
    nodeIntegration: true,
    contextIsolation: false,
    partition: "persist:myCustomPartition",
  },
});
```

- partitionï¼šç”¨äºå®šä¹‰è¯¥çª—å£æ•°æ®å­˜å‚¨çš„ç‹¬ç«‹æ€§å’ŒæŒä¹…æ€§
  - persistï¼šè¿™æ˜¯ä¸€ä¸ªå‰ç¼€ï¼Œè¯¥å‰ç¼€è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæŒä¹…æ€§çš„ä¼šè¯
  - myCustomPartitionï¼šè¿™ä¸ªæ ‡è¯†ç¬¦ä»£è¡¨è¯¥ä¼šè¯çš„å”¯ä¸€åç§°ã€‚è¿™é‡Œå°±æ˜¯é€šè¿‡ä¸åŒçš„ partition åç§°ï¼Œç»™åº”ç”¨ä¸­çš„ä¸åŒçª—å£åˆ›å»ºäº†éš”ç¦»çš„å­˜å‚¨ç©ºé—´ã€‚

## IndexedDB

IndexedDB æ˜¯ä¸€ç§ä½çº§çš„ APIï¼Œç”¨äºåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­å­˜å‚¨å¤§é‡çš„ç»“æ„åŒ–æ•°æ®ã€‚è¿™ä¸ª API ä½¿ç”¨ç´¢å¼•æ¥å®ç°å¯¹æ•°æ®çš„é«˜æ€§èƒ½æœç´¢ã€‚å®ƒå…è®¸ä½ åˆ›å»ºã€è¯»å–ã€å¯¼èˆªå’Œå†™å…¥å®¢æˆ·ç«¯æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚IndexedDB å¯¹äºéœ€è¦åœ¨å®¢æˆ·ç«¯å­˜å‚¨å¤§é‡æ•°æ®æˆ–æ— éœ€æŒç»­è”ç½‘çš„åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ã€‚

### åŸºç¡€ä»‹ç»

- **æ•°æ®åº“**ï¼šIndexedDB åˆ›å»ºçš„æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­å­˜å‚¨é”®å€¼å¯¹ã€‚
- **å¯¹è±¡ä»“åº“**ï¼šè¿™æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªâ€œè¡¨â€ï¼Œç”¨äºå­˜å‚¨æ•°æ®å¯¹è±¡ã€‚
- **äº‹åŠ¡**ï¼šæ•°æ®çš„è¯»å†™æ“ä½œæ˜¯é€šè¿‡äº‹åŠ¡è¿›è¡Œçš„ã€‚
- **é”®**ï¼šæ•°æ®å­˜å‚¨çš„æ ‡è¯†ã€‚
- **ç´¢å¼•**ï¼šç”¨äºé«˜æ•ˆæœç´¢æ•°æ®ã€‚

### æ‰“å¼€æ•°æ®åº“

åœ¨ä½¿ç”¨ IndexedDB ä¹‹å‰ï¼Œéœ€è¦æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºå®ƒã€‚

```javascript
let db;
const request = indexedDB.open("MyTestDatabase", 1);

request.onerror = function (event) {
  // é”™è¯¯å¤„ç†
  console.log("Database error: " + event.target.errorCode);
};

request.onsuccess = function (event) {
  db = event.target.result;
};
```

### åˆ›å»ºå¯¹è±¡ä»“åº“

å¯¹è±¡ä»“åº“ç±»ä¼¼äº SQL æ•°æ®åº“ä¸­çš„è¡¨ã€‚ä»¥ä¸‹æ˜¯åœ¨æ•°æ®åº“çš„å‡çº§è¿‡ç¨‹ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“çš„ç¤ºä¾‹ï¼š

```javascript
request.onupgradeneeded = function (event) {
  const db = event.target.result;

  // åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“æ¥å­˜å‚¨æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ "id" ä½œä¸ºé”®è·¯å¾„ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾å®ƒæ˜¯å”¯ä¸€çš„ã€‚
  const objectStore = db.createObjectStore("name", { keyPath: "id" });

  // åˆ›å»ºä¸€ä¸ªç´¢å¼•æ¥é€šè¿‡ name è¿›è¡Œæœç´¢ã€‚
  objectStore.createIndex("name", "name", { unique: false });
};
```

### æ·»åŠ æ•°æ®

ä¸€æ—¦æœ‰äº†å¯¹è±¡ä»“åº“ï¼Œå°±å¯ä»¥å¾€é‡Œé¢æ·»åŠ æ•°æ®äº†ã€‚è¿™éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆã€‚

```javascript
function addData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");

  const data = { id: "1", name: "Zhang San" };
  const request = objectStore.add(data);

  request.onsuccess = function (event) {
    console.log("æ•°æ®æ·»åŠ æˆåŠŸ");
  };

  request.onerror = function (event) {
    console.log("æ•°æ®æ·»åŠ å¤±è´¥");
  };
}
```

### è¯»å–æ•°æ®

ä»å¯¹è±¡ä»“åº“ä¸­è¯»å–æ•°æ®ä¹Ÿå¾ˆç®€å•ï¼š

```javascript
function readData() {
  const transaction = db.transaction(["name"]);
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1"); // ä½¿ç”¨ id è¯»å–æ•°æ®

  request.onerror = function (event) {
    console.log("äº‹åŠ¡å¤±è´¥");
  };

  request.onsuccess = function (event) {
    if (request.result) {
      console.log("Name: " + request.result.name);
    } else {
      console.log("æœªæ‰¾åˆ°æ•°æ®");
    }
  };
}
```

### æ›´æ–°æ•°æ®

æ›´æ–°æ•°æ®ä¸æ·»åŠ æ•°æ®ç±»ä¼¼ï¼Œä½†é€šå¸¸ä¼šå…ˆè¯»å–ç°æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ã€‚

```javascript
function updateData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1");

  request.onsuccess = function (event) {
    const data = event.target.result;
    data.name = "Li Si"; // ä¿®æ”¹åç§°

    const requestUpdate = objectStore.put(data);
    requestUpdate.onerror = function (event) {
      console.log("æ›´æ–°å¤±è´¥");
    };
    requestUpdate.onsuccess = function (event) {
      console.log("æ›´æ–°æˆåŠŸ");
    };
  };
}
```

### åˆ é™¤æ•°æ®

åˆ é™¤æ•°æ®ä¹Ÿå¾ˆç›´æ¥ï¼š

```javascript
function deleteData() {
  const request = db
    .transaction(["name"], "readwrite")
    .objectStore("name")
    .delete("1");

  request.onsuccess = function (event) {
    console.log("æ•°æ®åˆ é™¤æˆåŠŸ");
  };
}
```

ä»¥ä¸Šå°±æ˜¯ IndexedDB çš„åŸºæœ¬ç”¨æ³•ã€‚é€šè¿‡è¿™äº›åŸºæœ¬æ“ä½œï¼Œå¯ä»¥åœ¨å‰ç«¯åº”ç”¨ä¸­å®ç°å¤æ‚çš„æ•°æ®å­˜å‚¨éœ€æ±‚ã€‚ä¸è¿‡ï¼Œè®°å¾— IndexedDB çš„æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦ç®¡ç†å¥½å›è°ƒæˆ–è€…ä½¿ç”¨`async/await`æ¥å¤„ç†è¿™äº›å¼‚æ­¥æ“ä½œã€‚

## Dexie.js

é™¤äº†ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„ IndexedDB ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Dexie.jsï¼Œè¯¥ç¬¬ä¸‰æ–¹åº“æä¾›äº†<u>æ›´ç®€æ´ã€æ›´æ˜“ç”¨</u>çš„ APIã€‚

**IndexedDB**

1. **åŸç”Ÿ Web API**ï¼šIndexedDB æ˜¯ä¸€ä¸ªä½çº§çš„ APIï¼Œç›´æ¥å†…ç½®äºç°ä»£æµè§ˆå™¨ä¸­ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®ã€‚
2. **å¤æ‚æ€§**ï¼šç›´æ¥ä½¿ç”¨ IndexedDB å¯èƒ½ç›¸å½“å¤æ‚ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„å¼‚æ­¥æ€§è´¨å’Œç¹ççš„é”™è¯¯å¤„ç†ã€‚å®ƒçš„ API è®¾è®¡æ›´åå‘äºåº•å±‚ï¼Œæä¾›äº†å¤§é‡çš„çµæ´»æ€§ï¼Œä½†ä¹Ÿä½¿å¾—ç®€å•æ“ä½œå˜å¾—å¤æ‚ã€‚
3. **äº‹åŠ¡ç®¡ç†**ï¼šIndexedDB éœ€è¦æ˜¾å¼åœ°å¤„ç†äº‹åŠ¡ã€‚äº‹åŠ¡ã€å¯¹è±¡å­˜å‚¨ã€ç´¢å¼•ç­‰éœ€è¦ä»”ç»†ç®¡ç†å’Œåè°ƒã€‚
4. **æ— åŒ…è£…å™¨**ï¼šç›´æ¥ä½¿ç”¨ IndexedDB æ„å‘³ç€ç¼–å†™æ›´å¤šçš„å¼•å¯¼å’Œè®¾ç½®ä»£ç ï¼Œä¾‹å¦‚å¤„ç†æ•°æ®åº“çš„ç‰ˆæœ¬å‡çº§é€»è¾‘ã€‚

**Dexie.js**

1. **å°è£…åº“**ï¼šDexie.js æ˜¯ä¸€ä¸ªå¯¹ IndexedDB è¿›è¡Œå°è£…çš„åº“ï¼Œæä¾›äº†ä¸€ä¸ªç®€å•ã€æ›´æ˜“äºç†è§£å’Œä½¿ç”¨çš„ APIã€‚
2. **ç®€åŒ–çš„æ“ä½œ**ï¼šé€šè¿‡ Dexie.jsï¼Œå¤æ‚çš„ IndexedDB æ“ä½œå˜å¾—æ›´ç®€å•ã€‚ä¾‹å¦‚ï¼Œå®ƒç®€åŒ–äº†å¼‚æ­¥æ“ä½œçš„å¤„ç†ï¼Œä½¿å¾—ä½¿ç”¨ promises å’Œ async/await å˜å¾—ç›´è§‚ã€‚
3. **é”™è¯¯å¤„ç†**ï¼šDexie.js æä¾›äº†æ›´åŠ å‹å¥½å’Œç®€æ´çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚
4. **å¼ºåŒ–çš„åŠŸèƒ½**ï¼šDexie.js å¢åŠ äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚ç®€åŒ–çš„ç´¢å¼•æŸ¥è¯¢å’Œæ‰¹é‡æ“ä½œã€‚
5. **äº‹åŠ¡ç®¡ç†**ï¼šDexie.js ç®€åŒ–äº†äº‹åŠ¡ç®¡ç†ã€‚ä½ ä»ç„¶éœ€è¦ç†è§£ IndexedDB çš„äº‹åŠ¡æ¦‚å¿µï¼Œä½† Dexie.js æä¾›äº†æ›´ç®€å•çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚
6. **æ˜“äºå‡çº§**ï¼šåœ¨ Dexie.js ä¸­ï¼Œå¤„ç†æ•°æ®åº“çš„ç‰ˆæœ¬å‡çº§æ›´åŠ ç®€å•å’Œç›´è§‚ã€‚

**Dexie.js çš„ä¼˜åŠ¿**

- **æ›´ç®€æ´çš„ä»£ç **ï¼šä½¿ç”¨ Dexie.js å¯ä»¥å†™å‡ºæ›´æ¸…æ™°ã€æ›´ç®€æ´çš„ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚æŸ¥è¯¢å’Œå¤§é‡çš„å¼‚æ­¥æ“ä½œæ—¶ã€‚
- **æ˜“äºç»´æŠ¤**ï¼šç”±äº API æ›´åŠ ç®€å•ï¼Œç»´æŠ¤å’Œæ›´æ–°ä½¿ç”¨ Dexie.js ç¼–å†™çš„ä»£ç é€šå¸¸æ¯”ç›´æ¥ä½¿ç”¨ IndexedDB æ›´å®¹æ˜“ã€‚
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**ï¼šDexie.js æä¾›äº†æ›´å‹å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæœ‰åŠ©äºæ›´å®¹æ˜“åœ°è¯Šæ–­é—®é¢˜ã€‚
- **ç¤¾åŒºæ”¯æŒ**ï¼šDexie.js æ‹¥æœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›äº†ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒã€‚

ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹å®ƒçš„åŸºæœ¬è¯­æ³•ï¼š

```js
let db = new Dexie("testDb");
db.version(1).stores({ articles: "id", settings: "id" });
```

ç¬¬ä¸€è¡Œåˆ›å»ºä¸€ä¸ªåä¸º _testDb_ çš„ _IndexedDB_ æ•°æ®åº“ã€‚ç¬¬äºŒè¡Œä¸­çš„ _db.version(1)_ è¡¨ç¤ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚

åœ¨ _IndexedDB_ ä¸­ï¼Œæœ‰ç‰ˆæœ¬çš„æ¦‚å¿µï¼Œä¾‹å¦‚å‡è®¾ç°åœ¨çš„åº”ç”¨çš„æ•°æ®åº“ç‰ˆæœ¬å·ä¸º _1_ï¼ˆé»˜è®¤å€¼ä¹Ÿæ˜¯ _1_ï¼‰ï¼Œæ–°ç‰ˆæœ¬åº”ç”¨å¸Œæœ›æ›´æ–°æ•°æ®ç»“æ„ï¼Œå¯ä»¥æŠŠæ•°æ®åº“ç‰ˆæœ¬å·è®¾ç½®ä¸º _2_ã€‚å½“ç”¨æˆ·æ‰“å¼€åº”ç”¨è®¿é—®æ•°æ®æ—¶ï¼Œä¼šè§¦å‘ _IndexedDB_ çš„ _upgradeneeded_ äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤äº‹ä»¶ä¸­å®Œæˆæ•°æ®çš„è¿ç§»å·¥ä½œã€‚

åœ¨ _Dexie.js_ ä¸­ï¼Œå¯¹ _IndexedDB_ çš„ç‰ˆæœ¬ _API_ è¿›è¡Œäº†å°è£…ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ _db.version_ æ–¹æ³•è·å¾—å½“å‰ç‰ˆæœ¬çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ä¾‹æ–¹æ³• _stores_ï¼Œå¹¶ä¼ å…¥æ•°æ®ç»“æ„å¯¹è±¡ã€‚

æ•°æ®ç»“æ„å¯¹è±¡ç›¸å½“äºä¼ ç»Ÿæ•°æ®åº“çš„è¡¨ï¼Œä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…ä¸ºæ•°æ®ç»“æ„å¯¹è±¡æŒ‡å®šæ¯ä¸€ä¸ªå­—æ®µçš„å­—æ®µåï¼Œæ­¤å¤„æˆ‘ä»¬ä¸º _IndexedDB_ æ·»åŠ äº†ä¸¤ä¸ªè¡¨ _articles_ å’Œ _settings_ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå¿…å¤‡å­—æ®µ _id_ï¼Œå…¶ä»–å­—æ®µå¯ä»¥åœ¨å†™å…¥æ•°æ®æ—¶ä¸´æ—¶å†³å®šã€‚

å°†æ¥å¦‚æœç‰ˆæœ¬æ›´æ–°ï¼Œæ•°æ®åº“ç‰ˆæœ¬å·å˜ä¸º _2_ æ—¶ï¼Œæ•°æ®åº“å¢åŠ äº†ä¸€å¼ è¡¨ _users_ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
db.version(2).stores({ articles: "id", settings: "id", users: "id" });
```

æ­¤æ—¶ _Dexie.js_ ä¼šä¸ºæˆ‘ä»¬è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œåœ¨å¢åŠ æ–°çš„è¡¨çš„åŒæ—¶ï¼ŒåŸæœ‰è¡¨ä»¥åŠè¡¨é‡Œé¢çš„æ•°æ®ä¸å˜ã€‚è¿™ä¸ºæˆ‘ä»¬ä»å®¹åœ°æ§åˆ¶å®¢æˆ·ç«¯æ•°æ®åº“ç‰ˆæœ¬æä¾›äº†å¼ºæœ‰åŠ›çš„æ”¯æ’‘ã€‚

ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ _Dexie.js_ è¿›è¡Œå¸¸ç”¨æ•°æ®æ“ä½œçš„ä»£ç ï¼š

```js
// å¢åŠ æ•°æ®
await db.articles.add({ id: 0, title: "test" });

// æŸ¥è¯¢æ•°æ®
await db.articles.filter((article) => article.title === "test");

// ä¿®æ”¹æ•°æ®
await db.articles.put({ id: 0, title: "testtest" });

// åˆ é™¤æ•°æ®
await db.articles.delete(id);

// æ’åºæ•°æ®
await db.articles.orderBy("title");
```

æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç ä¸­ä½¿ç”¨åˆ°äº† _await_ å…³é”®å­—ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ï¼Œåº”è¯¥æ”¾åœ¨ _async_ æ ‡è®°çš„å‡½æ•°é‡Œé¢æ‰èƒ½æ­£å¸¸æ‰§è¡Œã€‚

æ›´å¤šæœ‰å…³ _Dexie.js_ çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚é˜…å®˜ç½‘ï¼š*https://dexie.org/*

# æµè§ˆå™¨æŠ€æœ¯æŒä¹…åŒ–

- localStorage
- IndexedDB
- Dexie.js

## localStorage

åœ¨ Electron ä¸­ï¼Œå¦‚æœä½ æ‰“å¼€äº†å¤šä¸ª BrowserWindow çš„å®ä¾‹ï¼Œé‚£ä¹ˆå®ƒä»¬é»˜è®¤æƒ…å†µä¸‹ä¼šå…±äº«åŒä¸€ä¸ª localStorage ç©ºé—´ã€‚

å¦å¤–ï¼Œå…³äºå¤šä¸ªçª—å£æ˜¯å¦å…±äº« localStorage è¿™ä¸€ç‚¹ï¼Œè™½ç„¶é»˜è®¤æ˜¯å¤šçª—å£å…±äº«ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è¿›è¡Œé…ç½®çš„ã€‚

ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºçª—å£äºŒçš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š

```js
const secondWin = new BrowserWindow({
  width: 800,
  height: 600,
  webPreferences: {
    nodeIntegration: true,
    contextIsolation: false,
    partition: "persist:myCustomPartition",
  },
});
```

- partitionï¼šç”¨äºå®šä¹‰è¯¥çª—å£æ•°æ®å­˜å‚¨çš„ç‹¬ç«‹æ€§å’ŒæŒä¹…æ€§
  - persistï¼šè¿™æ˜¯ä¸€ä¸ªå‰ç¼€ï¼Œè¯¥å‰ç¼€è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæŒä¹…æ€§çš„ä¼šè¯
  - myCustomPartitionï¼šè¿™ä¸ªæ ‡è¯†ç¬¦ä»£è¡¨è¯¥ä¼šè¯çš„å”¯ä¸€åç§°ã€‚è¿™é‡Œå°±æ˜¯é€šè¿‡ä¸åŒçš„ partition åç§°ï¼Œç»™åº”ç”¨ä¸­çš„ä¸åŒçª—å£åˆ›å»ºäº†éš”ç¦»çš„å­˜å‚¨ç©ºé—´ã€‚

## IndexedDB

IndexedDB æ˜¯ä¸€ç§ä½çº§çš„ APIï¼Œç”¨äºåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­å­˜å‚¨å¤§é‡çš„ç»“æ„åŒ–æ•°æ®ã€‚è¿™ä¸ª API ä½¿ç”¨ç´¢å¼•æ¥å®ç°å¯¹æ•°æ®çš„é«˜æ€§èƒ½æœç´¢ã€‚å®ƒå…è®¸ä½ åˆ›å»ºã€è¯»å–ã€å¯¼èˆªå’Œå†™å…¥å®¢æˆ·ç«¯æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚IndexedDB å¯¹äºéœ€è¦åœ¨å®¢æˆ·ç«¯å­˜å‚¨å¤§é‡æ•°æ®æˆ–æ— éœ€æŒç»­è”ç½‘çš„åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ã€‚

### åŸºç¡€ä»‹ç»

- **æ•°æ®åº“**ï¼šIndexedDB åˆ›å»ºçš„æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­å­˜å‚¨é”®å€¼å¯¹ã€‚
- **å¯¹è±¡ä»“åº“**ï¼šè¿™æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªâ€œè¡¨â€ï¼Œç”¨äºå­˜å‚¨æ•°æ®å¯¹è±¡ã€‚
- **äº‹åŠ¡**ï¼šæ•°æ®çš„è¯»å†™æ“ä½œæ˜¯é€šè¿‡äº‹åŠ¡è¿›è¡Œçš„ã€‚
- **é”®**ï¼šæ•°æ®å­˜å‚¨çš„æ ‡è¯†ã€‚
- **ç´¢å¼•**ï¼šç”¨äºé«˜æ•ˆæœç´¢æ•°æ®ã€‚

### æ‰“å¼€æ•°æ®åº“

åœ¨ä½¿ç”¨ IndexedDB ä¹‹å‰ï¼Œéœ€è¦æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºå®ƒã€‚

```javascript
let db;
const request = indexedDB.open("MyTestDatabase", 1);

request.onerror = function (event) {
  // é”™è¯¯å¤„ç†
  console.log("Database error: " + event.target.errorCode);
};

request.onsuccess = function (event) {
  db = event.target.result;
};
```

### åˆ›å»ºå¯¹è±¡ä»“åº“

å¯¹è±¡ä»“åº“ç±»ä¼¼äº SQL æ•°æ®åº“ä¸­çš„è¡¨ã€‚ä»¥ä¸‹æ˜¯åœ¨æ•°æ®åº“çš„å‡çº§è¿‡ç¨‹ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“çš„ç¤ºä¾‹ï¼š

```javascript
request.onupgradeneeded = function (event) {
  const db = event.target.result;

  // åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“æ¥å­˜å‚¨æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ "id" ä½œä¸ºé”®è·¯å¾„ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾å®ƒæ˜¯å”¯ä¸€çš„ã€‚
  const objectStore = db.createObjectStore("name", { keyPath: "id" });

  // åˆ›å»ºä¸€ä¸ªç´¢å¼•æ¥é€šè¿‡ name è¿›è¡Œæœç´¢ã€‚
  objectStore.createIndex("name", "name", { unique: false });
};
```

### æ·»åŠ æ•°æ®

ä¸€æ—¦æœ‰äº†å¯¹è±¡ä»“åº“ï¼Œå°±å¯ä»¥å¾€é‡Œé¢æ·»åŠ æ•°æ®äº†ã€‚è¿™éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆã€‚

```javascript
function addData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");

  const data = { id: "1", name: "Zhang San" };
  const request = objectStore.add(data);

  request.onsuccess = function (event) {
    console.log("æ•°æ®æ·»åŠ æˆåŠŸ");
  };

  request.onerror = function (event) {
    console.log("æ•°æ®æ·»åŠ å¤±è´¥");
  };
}
```

### è¯»å–æ•°æ®

ä»å¯¹è±¡ä»“åº“ä¸­è¯»å–æ•°æ®ä¹Ÿå¾ˆç®€å•ï¼š

```javascript
function readData() {
  const transaction = db.transaction(["name"]);
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1"); // ä½¿ç”¨ id è¯»å–æ•°æ®

  request.onerror = function (event) {
    console.log("äº‹åŠ¡å¤±è´¥");
  };

  request.onsuccess = function (event) {
    if (request.result) {
      console.log("Name: " + request.result.name);
    } else {
      console.log("æœªæ‰¾åˆ°æ•°æ®");
    }
  };
}
```

### æ›´æ–°æ•°æ®

æ›´æ–°æ•°æ®ä¸æ·»åŠ æ•°æ®ç±»ä¼¼ï¼Œä½†é€šå¸¸ä¼šå…ˆè¯»å–ç°æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ã€‚

```javascript
function updateData() {
  const transaction = db.transaction(["name"], "readwrite");
  const objectStore = transaction.objectStore("name");
  const request = objectStore.get("1");

  request.onsuccess = function (event) {
    const data = event.target.result;
    data.name = "Li Si"; // ä¿®æ”¹åç§°

    const requestUpdate = objectStore.put(data);
    requestUpdate.onerror = function (event) {
      console.log("æ›´æ–°å¤±è´¥");
    };
    requestUpdate.onsuccess = function (event) {
      console.log("æ›´æ–°æˆåŠŸ");
    };
  };
}
```

### åˆ é™¤æ•°æ®

åˆ é™¤æ•°æ®ä¹Ÿå¾ˆç›´æ¥ï¼š

```javascript
function deleteData() {
  const request = db
    .transaction(["name"], "readwrite")
    .objectStore("name")
    .delete("1");

  request.onsuccess = function (event) {
    console.log("æ•°æ®åˆ é™¤æˆåŠŸ");
  };
}
```

ä»¥ä¸Šå°±æ˜¯ IndexedDB çš„åŸºæœ¬ç”¨æ³•ã€‚é€šè¿‡è¿™äº›åŸºæœ¬æ“ä½œï¼Œå¯ä»¥åœ¨å‰ç«¯åº”ç”¨ä¸­å®ç°å¤æ‚çš„æ•°æ®å­˜å‚¨éœ€æ±‚ã€‚ä¸è¿‡ï¼Œè®°å¾— IndexedDB çš„æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦ç®¡ç†å¥½å›è°ƒæˆ–è€…ä½¿ç”¨`async/await`æ¥å¤„ç†è¿™äº›å¼‚æ­¥æ“ä½œã€‚

## Dexie.js

é™¤äº†ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„ IndexedDB ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Dexie.jsï¼Œè¯¥ç¬¬ä¸‰æ–¹åº“æä¾›äº†<u>æ›´ç®€æ´ã€æ›´æ˜“ç”¨</u>çš„ APIã€‚

**IndexedDB**

1. **åŸç”Ÿ Web API**ï¼šIndexedDB æ˜¯ä¸€ä¸ªä½çº§çš„ APIï¼Œç›´æ¥å†…ç½®äºç°ä»£æµè§ˆå™¨ä¸­ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®ã€‚
2. **å¤æ‚æ€§**ï¼šç›´æ¥ä½¿ç”¨ IndexedDB å¯èƒ½ç›¸å½“å¤æ‚ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„å¼‚æ­¥æ€§è´¨å’Œç¹ççš„é”™è¯¯å¤„ç†ã€‚å®ƒçš„ API è®¾è®¡æ›´åå‘äºåº•å±‚ï¼Œæä¾›äº†å¤§é‡çš„çµæ´»æ€§ï¼Œä½†ä¹Ÿä½¿å¾—ç®€å•æ“ä½œå˜å¾—å¤æ‚ã€‚
3. **äº‹åŠ¡ç®¡ç†**ï¼šIndexedDB éœ€è¦æ˜¾å¼åœ°å¤„ç†äº‹åŠ¡ã€‚äº‹åŠ¡ã€å¯¹è±¡å­˜å‚¨ã€ç´¢å¼•ç­‰éœ€è¦ä»”ç»†ç®¡ç†å’Œåè°ƒã€‚
4. **æ— åŒ…è£…å™¨**ï¼šç›´æ¥ä½¿ç”¨ IndexedDB æ„å‘³ç€ç¼–å†™æ›´å¤šçš„å¼•å¯¼å’Œè®¾ç½®ä»£ç ï¼Œä¾‹å¦‚å¤„ç†æ•°æ®åº“çš„ç‰ˆæœ¬å‡çº§é€»è¾‘ã€‚

**Dexie.js**

1. **å°è£…åº“**ï¼šDexie.js æ˜¯ä¸€ä¸ªå¯¹ IndexedDB è¿›è¡Œå°è£…çš„åº“ï¼Œæä¾›äº†ä¸€ä¸ªç®€å•ã€æ›´æ˜“äºç†è§£å’Œä½¿ç”¨çš„ APIã€‚
2. **ç®€åŒ–çš„æ“ä½œ**ï¼šé€šè¿‡ Dexie.jsï¼Œå¤æ‚çš„ IndexedDB æ“ä½œå˜å¾—æ›´ç®€å•ã€‚ä¾‹å¦‚ï¼Œå®ƒç®€åŒ–äº†å¼‚æ­¥æ“ä½œçš„å¤„ç†ï¼Œä½¿å¾—ä½¿ç”¨ promises å’Œ async/await å˜å¾—ç›´è§‚ã€‚
3. **é”™è¯¯å¤„ç†**ï¼šDexie.js æä¾›äº†æ›´åŠ å‹å¥½å’Œç®€æ´çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚
4. **å¼ºåŒ–çš„åŠŸèƒ½**ï¼šDexie.js å¢åŠ äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚ç®€åŒ–çš„ç´¢å¼•æŸ¥è¯¢å’Œæ‰¹é‡æ“ä½œã€‚
5. **äº‹åŠ¡ç®¡ç†**ï¼šDexie.js ç®€åŒ–äº†äº‹åŠ¡ç®¡ç†ã€‚ä½ ä»ç„¶éœ€è¦ç†è§£ IndexedDB çš„äº‹åŠ¡æ¦‚å¿µï¼Œä½† Dexie.js æä¾›äº†æ›´ç®€å•çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚
6. **æ˜“äºå‡çº§**ï¼šåœ¨ Dexie.js ä¸­ï¼Œå¤„ç†æ•°æ®åº“çš„ç‰ˆæœ¬å‡çº§æ›´åŠ ç®€å•å’Œç›´è§‚ã€‚

**Dexie.js çš„ä¼˜åŠ¿**

- **æ›´ç®€æ´çš„ä»£ç **ï¼šä½¿ç”¨ Dexie.js å¯ä»¥å†™å‡ºæ›´æ¸…æ™°ã€æ›´ç®€æ´çš„ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚æŸ¥è¯¢å’Œå¤§é‡çš„å¼‚æ­¥æ“ä½œæ—¶ã€‚
- **æ˜“äºç»´æŠ¤**ï¼šç”±äº API æ›´åŠ ç®€å•ï¼Œç»´æŠ¤å’Œæ›´æ–°ä½¿ç”¨ Dexie.js ç¼–å†™çš„ä»£ç é€šå¸¸æ¯”ç›´æ¥ä½¿ç”¨ IndexedDB æ›´å®¹æ˜“ã€‚
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**ï¼šDexie.js æä¾›äº†æ›´å‹å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæœ‰åŠ©äºæ›´å®¹æ˜“åœ°è¯Šæ–­é—®é¢˜ã€‚
- **ç¤¾åŒºæ”¯æŒ**ï¼šDexie.js æ‹¥æœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›äº†ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒã€‚

ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹å®ƒçš„åŸºæœ¬è¯­æ³•ï¼š

```js
let db = new Dexie("testDb");
db.version(1).stores({ articles: "id", settings: "id" });
```

ç¬¬ä¸€è¡Œåˆ›å»ºä¸€ä¸ªåä¸º _testDb_ çš„ _IndexedDB_ æ•°æ®åº“ã€‚ç¬¬äºŒè¡Œä¸­çš„ _db.version(1)_ è¡¨ç¤ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚

åœ¨ _IndexedDB_ ä¸­ï¼Œæœ‰ç‰ˆæœ¬çš„æ¦‚å¿µï¼Œä¾‹å¦‚å‡è®¾ç°åœ¨çš„åº”ç”¨çš„æ•°æ®åº“ç‰ˆæœ¬å·ä¸º _1_ï¼ˆé»˜è®¤å€¼ä¹Ÿæ˜¯ _1_ï¼‰ï¼Œæ–°ç‰ˆæœ¬åº”ç”¨å¸Œæœ›æ›´æ–°æ•°æ®ç»“æ„ï¼Œå¯ä»¥æŠŠæ•°æ®åº“ç‰ˆæœ¬å·è®¾ç½®ä¸º _2_ã€‚å½“ç”¨æˆ·æ‰“å¼€åº”ç”¨è®¿é—®æ•°æ®æ—¶ï¼Œä¼šè§¦å‘ _IndexedDB_ çš„ _upgradeneeded_ äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤äº‹ä»¶ä¸­å®Œæˆæ•°æ®çš„è¿ç§»å·¥ä½œã€‚

åœ¨ _Dexie.js_ ä¸­ï¼Œå¯¹ _IndexedDB_ çš„ç‰ˆæœ¬ _API_ è¿›è¡Œäº†å°è£…ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ _db.version_ æ–¹æ³•è·å¾—å½“å‰ç‰ˆæœ¬çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ä¾‹æ–¹æ³• _stores_ï¼Œå¹¶ä¼ å…¥æ•°æ®ç»“æ„å¯¹è±¡ã€‚

æ•°æ®ç»“æ„å¯¹è±¡ç›¸å½“äºä¼ ç»Ÿæ•°æ®åº“çš„è¡¨ï¼Œä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…ä¸ºæ•°æ®ç»“æ„å¯¹è±¡æŒ‡å®šæ¯ä¸€ä¸ªå­—æ®µçš„å­—æ®µåï¼Œæ­¤å¤„æˆ‘ä»¬ä¸º _IndexedDB_ æ·»åŠ äº†ä¸¤ä¸ªè¡¨ _articles_ å’Œ _settings_ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå¿…å¤‡å­—æ®µ _id_ï¼Œå…¶ä»–å­—æ®µå¯ä»¥åœ¨å†™å…¥æ•°æ®æ—¶ä¸´æ—¶å†³å®šã€‚

å°†æ¥å¦‚æœç‰ˆæœ¬æ›´æ–°ï¼Œæ•°æ®åº“ç‰ˆæœ¬å·å˜ä¸º _2_ æ—¶ï¼Œæ•°æ®åº“å¢åŠ äº†ä¸€å¼ è¡¨ _users_ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
db.version(2).stores({ articles: "id", settings: "id", users: "id" });
```

æ­¤æ—¶ _Dexie.js_ ä¼šä¸ºæˆ‘ä»¬è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œåœ¨å¢åŠ æ–°çš„è¡¨çš„åŒæ—¶ï¼ŒåŸæœ‰è¡¨ä»¥åŠè¡¨é‡Œé¢çš„æ•°æ®ä¸å˜ã€‚è¿™ä¸ºæˆ‘ä»¬ä»å®¹åœ°æ§åˆ¶å®¢æˆ·ç«¯æ•°æ®åº“ç‰ˆæœ¬æä¾›äº†å¼ºæœ‰åŠ›çš„æ”¯æ’‘ã€‚

ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ _Dexie.js_ è¿›è¡Œå¸¸ç”¨æ•°æ®æ“ä½œçš„ä»£ç ï¼š

```js
// å¢åŠ æ•°æ®
await db.articles.add({ id: 0, title: "test" });

// æŸ¥è¯¢æ•°æ®
await db.articles.filter((article) => article.title === "test");

// ä¿®æ”¹æ•°æ®
await db.articles.put({ id: 0, title: "testtest" });

// åˆ é™¤æ•°æ®
await db.articles.delete(id);

// æ’åºæ•°æ®
await db.articles.orderBy("title");
```

æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç ä¸­ä½¿ç”¨åˆ°äº† _await_ å…³é”®å­—ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ï¼Œåº”è¯¥æ”¾åœ¨ _async_ æ ‡è®°çš„å‡½æ•°é‡Œé¢æ‰èƒ½æ­£å¸¸æ‰§è¡Œã€‚

æ›´å¤šæœ‰å…³ _Dexie.js_ çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚é˜…å®˜ç½‘ï¼š*https://dexie.org/*
